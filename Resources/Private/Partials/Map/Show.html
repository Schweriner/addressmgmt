<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" xmlns:u="http://typo3.org/ns/Undkonsorten/Addressmgmt/ViewHelpers" data-namespace-typo3-fluid="true">

<div class="map-wrap{f:if(condition:settings.showFilter,then:' map-with-filter')}" id="map{contendUid}-wrap">
  <div class="filter-wrap">
    <f:render partial="Filter/Form" arguments="{_all}" />
  </div>
  <div class="map" id="map{contendUid}" data-map-clusters="{settings.useMarkerClusters}" data-map-info-layer="#map{contendUid}-info-layer" data-map-wrap="#map{contendUid}-wrap" data-is-map="true" data-poi-list="#map{contendUid}-items" data-map-configuration="{settings.mapConfiguration -> u:format.json() -> f:format.htmlspecialchars()}" data-map-tilelayer="{settings.tileLayerConfiguration -> u:format.json() -> f:format.htmlspecialchars()}">
    <div class="update-map"><p><f:translate key="addressmgmt.updateMap" /></p></div>
  </div>
  <div class="map-info-layer" id="map{contendUid}-info-layer"></div>
  <ul id="map{contendUid}-items" class="map-list-items filter-list-items" style="display:none">
    <f:for each="{addresss}" as="address">
      <f:if condition="{address.latitude}">
        <f:then>
          <li class="filter-list-item list-item{f:if(condition:address.images,then:' with-img', else: ' no-img')}" data-poi="{u:format.json(additionalAttributes:{type:'marker',coordinates:{0:address.latitude,1:address.longitude}}) -> f:format.htmlspecialchars()}" data-filter="{f:render(partial:'List/CategoryUids',arguments:'{address:address}')}">
            <f:render partial="List/MapItem" arguments="{address: address}" />
          </li>
        </f:then>
        <f:else>
          <f:if condition="{address.geoJson}">
            <li class="filter-list-item list-item{f:if(condition:address.images,then:' with-img', else: ' no-img')}" data-poi="{u:format.json(additionalAttributes:{type:'geoJson',geoJson:address.geoJsonObject}) -> f:format.htmlspecialchars()}" data-filter="{f:render(partial:'List/CategoryUids',arguments:'{address:address}')}">
              <f:render partial="List/MapItem" arguments="{address: address}" />
            </li>
          </f:if>
        </f:else>
      </f:if>
    </f:for>
  </ul>
</div>
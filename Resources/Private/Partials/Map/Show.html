{namespace u = Undkonsorten\Addressmgmt\ViewHelpers}
<div id="map" style="width: 490px; height: 620px"></div>
<script>
	 var map = L.map('map').setView([{settings.latitude}, {settings.longitude}], 10);

	
	<u:mapBoxTileLayer 
		id="{settings.id}" 
		accesssToken="{settings.accessToken}" 
		maxZoom="{settings.maxZoom}" 
		attribution="Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery Â© <a href=\"http://mapbox.com\">Mapbox</a>">

	</u:mapBoxTileLayer> 
	
	<f:for each="{addresses}" as="address">
		<f:if condition="{address.latitude}">
			<f:if condition="{address.longitude}">
				L.marker([{address.latitude}, {address.longitude}]).addTo(map).bindPopup('<b>{address.name}</b>')
			</f:if>
		</f:if>
		<f:if condition="{address.geojson}">
	   	 	var geojson{address.uid} = <f:format.raw>{address.geojson}</f:format.raw>;
			L.geoJson(geojson{address.uid}).addTo(map);
 		</f:if>
	</f:for>

</script>
